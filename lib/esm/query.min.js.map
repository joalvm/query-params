{"version":3,"file":"query.min.js","sources":["../../../src/query.ts"],"sourcesContent":["/**\r\n * Utilitario para manejar los parametros como objeto y luego convertirlos a string\r\n * y unirlos a una url.\r\n */\r\nexport default class Query {\r\n    /**\r\n     * @property {boolean}\r\n     */\r\n    private encode: boolean = false;\r\n\r\n    /**\r\n     *\r\n     * @param {Object} parameters Parametros a ser serializados.\r\n     * @param {string|undefined} url (Opcional) url que se unir√° a los parametros.\r\n     */\r\n    constructor(\r\n        private parameters: Record<string, any>,\r\n        private url: string = \"\"\r\n    ) {}\r\n\r\n    /**\r\n     * Serializa los parametros y lo concatena a la url.\r\n     *\r\n     * @param {boolean} encode Condificar los caracteres especiales.\r\n     * @returns {string}\r\n     */\r\n    serialize(encode: boolean = false): string {\r\n        this.encode = encode;\r\n\r\n        return this.concat(\r\n            Object.entries(this.flatten(this.parameters))\r\n                .map(this.handleEncode.bind(this))\r\n                .join(\"&\")\r\n        );\r\n    }\r\n\r\n    private concat(params: string) {\r\n        if (!this.url) {\r\n            return params;\r\n        }\r\n\r\n        return this.url.replace(/\\/$/, \"\") + \"?\" + params;\r\n    }\r\n\r\n    private handleEncode(pair: [string, string]): string {\r\n        return (this.encode ? pair.map(encodeURIComponent) : pair).join(\"=\");\r\n    }\r\n\r\n    private flatten(\r\n        obj: Record<string, any>,\r\n        path?: string,\r\n        result?: Record<string, any>\r\n    ): Record<string, string> {\r\n        // Si es la primerera llamada osea cuando no es un llamado de la recursividad\r\n        if (result === undefined) {\r\n            var type = Object.prototype.toString.call(obj);\r\n\r\n            if (type === \"[object Object]\") {\r\n                result = {};\r\n            } else if (type === \"[object Array]\") {\r\n                result = [];\r\n            } else {\r\n                return {};\r\n            }\r\n        }\r\n\r\n        for (var key in obj) {\r\n            if (!obj.hasOwnProperty(key)) {\r\n                continue;\r\n            }\r\n\r\n            if (!obj[key]) {\r\n                continue;\r\n            }\r\n\r\n            switch (Object.prototype.toString.call(obj[key])) {\r\n                case \"[object Array]\":\r\n                case \"[object Object]\":\r\n                    this.flatten(obj[key], this.join(key, path), result);\r\n                    break;\r\n                default:\r\n                    result[this.join(key, path)] = !this.encode\r\n                        ? encodeURIComponent(obj[key])\r\n                        : obj[key];\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    private join(key: string, path?: string): string {\r\n        if (path) {\r\n            return `${path}[${key}]`;\r\n        }\r\n\r\n        return key;\r\n    }\r\n}\r\n"],"names":["Query","parameters","url","encode","constructor","this","serialize","concat","Object","entries","flatten","map","handleEncode","bind","join","params","replace","pair","encodeURIComponent","obj","path","result","undefined","type","prototype","toString","call","key","hasOwnProperty"],"mappings":"AAIc,MAAOA,EAYLC,WACAC,IATJC,QAAkB,EAO1BC,YACYH,EACAC,EAAc,IADdG,KAAUJ,WAAVA,EACAI,KAAGH,IAAHA,CACR,CAQJI,UAAUH,GAAkB,GAGxB,OAFAE,KAAKF,OAASA,EAEPE,KAAKE,OACRC,OAAOC,QAAQJ,KAAKK,QAAQL,KAAKJ,aAC5BU,IAAIN,KAAKO,aAAaC,KAAKR,OAC3BS,KAAK,KAEjB,CAEOP,OAAOQ,GACX,OAAKV,KAAKH,IAIHG,KAAKH,IAAIc,QAAQ,MAAO,IAAM,IAAMD,EAHhCA,CAId,CAEOH,aAAaK,GACjB,OAAQZ,KAAKF,OAASc,EAAKN,IAAIO,oBAAsBD,GAAMH,KAAK,IACnE,CAEOJ,QACJS,EACAC,EACAC,GAGA,QAAeC,IAAXD,EAAsB,CACtB,IAAIE,EAAOf,OAAOgB,UAAUC,SAASC,KAAKP,GAE1C,GAAa,oBAATI,EACAF,EAAS,CAAA,MACN,IAAa,mBAATE,EAGP,MAAO,GAFPF,EAAS,EAGZ,CACJ,CAED,IAAK,IAAIM,KAAOR,EACZ,GAAKA,EAAIS,eAAeD,IAInBR,EAAIQ,GAIT,OAAQnB,OAAOgB,UAAUC,SAASC,KAAKP,EAAIQ,KACvC,IAAK,iBACL,IAAK,kBACDtB,KAAKK,QAAQS,EAAIQ,GAAMtB,KAAKS,KAAKa,EAAKP,GAAOC,GAC7C,MACJ,QACIA,EAAOhB,KAAKS,KAAKa,EAAKP,IAAUf,KAAKF,OAE/BgB,EAAIQ,GADJT,mBAAmBC,EAAIQ,IAMzC,OAAON,CACV,CAEOP,KAAKa,EAAaP,GACtB,OAAIA,EACO,GAAGA,KAAQO,KAGfA,CACV,SACJ3B"}